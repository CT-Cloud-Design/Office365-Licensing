function updateFlag(e,t){t?(e.src="/media/flagged.svg",e.title="Remove flag"):(e.src="/media/unflagged.svg",e.title="Flag this diagram")}function flagClick(e){const t=e.target,a=t.parentElement.getElementsByClassName("link-text").item(0),l=a.hash.substring(1),n=PageData.Flags.indexOf(l);-1===n?(PageData.Flags.push(l),updateFlag(t,!0)):(PageData.Flags.splice(n,1),updateFlag(t,!1)),localStorage.setItem(StoreName.Flags,JSON.stringify(PageData.Flags))}function flagAllClick(e){e.preventDefault(),PageData.Flags=[];const t=document.getElementsByClassName("link-text");for(let e=0;e<t.length;e+=1){const a=t[e],l=a.hash.substring(1);PageData.Flags.push(l);const n=a.parentElement.getElementsByClassName("link-flag").item(0);updateFlag(n,!0)}const a=JSON.stringify(PageData.Flags);localStorage.setItem(StoreName.Flags,a)}function clearFlagsClick(e){e.preventDefault(),PageData.Flags=[];const t=JSON.stringify(PageData.Flags);localStorage.setItem(StoreName.Flags,t);const a=document.getElementsByClassName("link-text");for(let e=0;e<a.length;e+=1){const t=a[e],l=t.parentElement.getElementsByClassName("link-flag").item(0);updateFlag(l,!1)}}function showFlags(){const e=localStorage.getItem(StoreName.Flags);e&&(PageData.Flags=JSON.parse(e));const t=document.getElementsByClassName("link-text");for(let e=0;e<t.length;e+=1){const a=t[e],l=a.parentElement.getElementsByClassName("link-flag").item(0);l.addEventListener("click",flagClick);const n=a.hash.substring(1),s=-1!==PageData.Flags.indexOf(n);updateFlag(l,s)}document.getElementById("clearAll").addEventListener("click",clearFlagsClick),document.getElementById("flagAll").addEventListener("click",flagAllClick)}function appOffline(){document.getElementById("offline").style.display="block"}function appOnline(){document.getElementById("offline").style.display="none"}function pageLoad(){showFlags(),isIE&&fixToMaxItemWidth("link-header",8,!1),document.getElementById("offline").style.display=navigator.onLine?"none":"block",window.addEventListener("offline",appOffline),window.addEventListener("online",appOnline)}const PageData={Flags:[]};registerServiceWorker(),window.addEventListener("load",pageLoad),loadSettings(),setTheme(Settings.Theme),addThemeListener(themeChange);